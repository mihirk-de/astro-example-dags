WITH source AS (
    SELECT *
    FROM {{ source('system_s', 'CdmReview') }}
    
)

SELECT
    id AS id,
    registrationid AS registration_id,
    reviewdate AS review_date,
    userid AS user_id,
    status AS status,
    datecreated AS date_created,
    datemodified AS date_modified,
    lastupdatedby AS last_updated_by,
    weight AS weight,
    height AS height,
    bmi AS bmi,
    waistcircumference AS waist_circumference,
    pulserate AS pulse_rate,
    pulserhythm AS pulse_rhythm,
    systolic AS systolic,
    diastolic AS diastolic,
    diabetesrelatedamputation AS diabetes_related_amputation,
    diabetesamputationdate AS diabetes_amputation_date,
    posteriortibial AS posterior_tibial,
    dorsalispedis AS dorsalis_pedis,
    vibrationsense AS vibration_sense,
    monofilamenttest AS monofilament_test,
    footulceration AS foot_ulceration,
    footdeformity AS foot_deformity,
    retinalscreening AS retinal_screening,
    retinalscreeningreferred AS retinal_screening_referred,
    weightbriefintervention AS weight_brief_intervention,
    weightsignposted AS weight_signposted,
    weightreferreddietitian AS weight_referred_dietitian,
    weightpatientdeclined AS weight_patient_declined,
    smokingstatus AS smoking_status,
    smokingbriefintervention AS smoking_brief_intervention,
    smokingsignposted AS smoking_signposted,
    smokingreferredhelpline AS smoking_referred_helpline,
    smokingreferredmedication AS smoking_referred_medication,
    smokingpatientdeclined AS smoking_patient_declined,
    alcoholriskscore AS alcohol_risk_score,
    alcoholfullaudit AS alcohol_full_audit,
    alcoholbriefintervention AS alcohol_brief_intervention,
    alcoholsignposted AS alcohol_signposted,
    alcoholreferredhelpline AS alcohol_referred_helpline,
    alcoholreferredspecialist AS alcohol_referred_specialist,
    alcoholpatientdeclined AS alcohol_patient_declined,
    physicalactivity AS physical_activity,
    physicalactivityadequacy AS physical_activity_adequacy,
    pabriefadvice AS pa_brief_advice,
    pasignposted AS pa_signposted,
    papatientdeclined AS pa_patient_declined,
    influenzavaccine AS influenza_vaccine,
    influenzavaccinedate AS influenza_vaccine_date,
    pneumococcalvaccine AS pneumococcal_vaccine,
    pneumococcalvaccinedate AS pneumococcal_vaccine_date,
    cvdriskscore AS cvd_risk_score,
    copdscore AS copd_score,
    chadscore AS cha_score,
    ecg AS ecg,
    ecgresult AS ecg_result,
    echocardiography AS echocardiography,
    echocardiographyresult AS echocardiography_result,
    spirometry AS spirometry,
    spirometryresult AS spirometry_result,
    ldlnotavailable AS ldl_not_available,
    bnpnotavailable AS bnp_not_available,
    probnpnotavailable AS pro_bnp_not_available,
    tft AS tft,
    lft AS lft,
    educationprovidedbygp AS education_provided_by_gp,
    referredtoeducationprogramme AS referred_to_education_programme,
    educationreferraldetails AS education_referral_details,
    agreedcareplan AS agreed_care_plan,
    medicationreview AS medication_review,
    footlimbnote AS foot_limb_note,
    acrnotavailable AS acr_not_available,
    myocardialinfarction AS myocardial_infarction,
    dementia AS dementia,
    cancerstage2 AS cancer_stage_2,
    seriousmobilityissues AS serious_mobility_issues,
    chronickidneydisease AS chronic_kidney_disease,
    significantmentalillness AS significant_mental_illness,
    othermajordiagnosis AS other_major_diagnosis,
    ecgresulttext AS ecg_result_text,
    echocardiographyresulttext AS echocardiography_result_text,
    consultationid AS consultation_id,
    istelehealthreview AS is_telehealth_review,
    egfrnotavailable AS egfr_not_available,
    gmsuserid AS gms_user_id,
    reviewinguserid AS reviewing_user_id,
    pcrsverified AS pcrs_verified,
    ispaid AS is_paid,
    paiddate AS paid_date,
    paidamount AS paid_amount,
    cdmprogrammeid AS cdm_programme_id,
    vapingstatus AS vaping_status,
    versionid AS version_id,
    fastingglucosenotavailable AS fasting_glucose_not_available,
    serumcreatininenotavailable AS serum_creatinine_not_available,
    hypertensionontreatment AS hypertension_on_treatment,
    inflammatoryarthritis AS inflammatory_arthritis,
    weightnoaction AS weight_no_action,
    covidvaccine AS covid_vaccine,
    covidvaccinestatus AS covid_vaccine_status,
    creatinineclearance AS creatinine_clearance,
    lastecgdate AS last_ecg_date,
    lastechodate AS last_echo_date,
    edattendance AS ed_attendance,
    unscheduledadmission AS unscheduled_admission,
    exacerbations AS exacerbations,
    privateclaim AS private_claim,
    versionminorid AS version_minor_id,
    gp_practice_id AS gp_practice_id
FROM source
